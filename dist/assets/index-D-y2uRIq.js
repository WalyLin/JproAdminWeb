import{X as r,k as c,S as f,a0 as k,r as s,o as D,c as T,d as n,J as Y,e as C,fy as I,w as p,f as _}from"./index-BTGspiIM.js";import R from"./index-CGZjNLzQ.js";const a={getList(e={}){return r({url:"jpro/plan/index",method:"get",params:e})},save(e={}){return r({url:"jpro/plan/save",method:"post",data:e})},update(e,d={}){return r({url:"jpro/plan/update/"+e,method:"put",data:d})},read(e){return r({url:"jpro/plan/read/"+e,method:"get"})},deletes(e){return r({url:"jpro/plan/delete",method:"delete",data:e})},getRecycleList(e={}){return r({url:"jpro/plan/recycle",method:"get",params:e})},recoverys(e){return r({url:"jpro/plan/recovery",method:"put",data:e})},realDeletes(e){return r({url:"jpro/plan/realDelete",method:"delete",data:e})},changeStatus(e={}){return r({url:"jpro/plan/changeStatus",method:"put",data:e})},numberOperation(e={}){return r({url:"jpro/plan/numberOperation",method:"put",data:e})},importExcel(e={}){return r({url:"jpro/plan/import",method:"post",data:e})},downloadTemplate(){return r({url:"jpro/plan/downloadTemplate",method:"post",responseType:"blob"})},exportExcel(e={}){return r({url:"jpro/plan/export",method:"post",responseType:"blob",params:e})}},V={class:"ma-content-block lg:flex justify-between p-4"},A={name:"jpro:plan"},q=Object.assign(A,{setup(e){const d=c(),o=c(!1),h=()=>{o.value=!0},i=t=>(t.user_id=t.username_and_nickname,t.plan_type=t.plan_type_name,t.status==0&&delete t.status,delete t.username_and_nickname,delete t.plan_type_name,t),y=f({id:"jpro_plan",rowSelection:{showCheckedAll:!0},pk:"id",operationColumn:!0,operationColumnWidth:160,operationColumnFixed:!1,formOption:{viewType:"modal",width:600},beforeRequest:t=>{i(t)},beforeAdd:t=>i(t),beforeEdit:t=>(console.info(t),t),api:a.getList,recycleApi:a.getRecycleList,add:{show:!0,api:a.save,auth:["jpro:plan:save"]},edit:{show:!0,api:a.update,auth:["jpro:plan:update"]},delete:{show:!0,api:a.deletes,auth:["jpro:plan:delete"],realApi:a.realDeletes,realAuth:["jpro:plan:realDeletes"]},recovery:{show:!0,api:a.recoverys,auth:["jpro:plan:recovery"]},import:{show:!0,url:"jpro/plan/import",templateUrl:"jpro/plan/downloadTemplate",auth:["jpro:plan:import"]},export:{show:!0,url:"jpro/plan/export",auth:["jpro:plan:export"]},formOption:{width:800,layout:[]}}),j=f([{title:"",dataIndex:"id",formType:"input",addDisplay:!1,editDisplay:!1,hide:!0,commonRules:{required:!0,message:"请输入"}},{title:"用户",dataIndex:"username_and_nickname",formType:"select",search:!0,dict:{url:"system/user/getList",props:{label:"username_and_nickname",value:"id"}},commonRules:[{required:!0,message:"用户必选"}]},{title:"任务类型",dataIndex:"plan_type_name",formType:"select",search:!0,dict:{remote:"jpro/planType/remote",props:{label:"name",value:"id"}},translation:!0},{title:"详情",dataIndex:"detail",formType:"editor",hide:!0},{title:"备注",dataIndex:"remark",formType:"input",addDisplay:!0,editDisplay:!0,hide:!0},{title:"计划时间",dataIndex:"time",formType:"date",format:"YYYY-MM-DD HH:mm",addDefaultValue:k().format("YYYY-MM-DD 00:00"),search:!0,showTime:!0},{title:"状态",dataIndex:"status",formType:"radio",search:!0,commonRules:{required:!0,message:"请输入状态"},dict:{name:"plan_status",translation:!0,tagColors:{2:"green"}},addDefaultValue:1}]);return(t,u)=>{const v=s("a-range-picker"),x=s("a-button"),b=s("a-modal"),w=s("ma-crud");return D(),T("div",V,[n(w,{options:y,columns:j,ref_key:"crudRef",ref:d},Y({"search-time":p(({searchForm:l,component:m})=>[n(v,{modelValue:l[m.dataIndex],"onUpdate:modelValue":g=>l[m.dataIndex]=g,style:{width:"360px",margin:"0 24px 24px 0"},"show-time":"","time-picker-props":{defaultValue:["00:00:00","23:59:59"]},format:"YYYY-MM-DD HH:mm"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},[C(I)("jpro:plan:delete")?{name:"tableAfterButtons",fn:p(()=>[n(x,{onClick:h,type:"primary"},{default:p(()=>[_("任务类型管理")]),_:1}),n(b,{visible:o.value,"onUpdate:visible":u[1]||(u[1]=l=>o.value=l),footer:!1,width:"70%"},{title:p(()=>[_("任务类型管理")]),default:p(()=>[n(R,{ref:"planTypeListRef",visible:o.value,onClose:u[0]||(u[0]=l=>o.value=!1)},null,8,["visible"])]),_:1},8,["visible"])]),key:"0"}:void 0]),1032,["options","columns"])])}}});export{q as default};
