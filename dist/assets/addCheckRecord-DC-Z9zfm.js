import{_ as T,j as k}from"./image-CnA_qWXJ.js";import{k as o,fx as V,x as I,a0 as j,S as m,a9 as Y,r as n,o as C,h as M,w as c,f as D,d as F,M as d}from"./index-lllkz6-0.js";const q={__name:"addCheckRecord",props:{mother:{type:Object,required:!0},parentCrudRef:{type:Object,required:!0}},setup(p,{expose:f}){const a=p,r=o(),t=o({}),l=o(!1),u=o(!1);V(e=>{u.value=e.isFull}),I(()=>a.mother,e=>{t.value.mother_id=e.id,t.value.hospital_id=e.hospital_id,t.value.doctor_id=e.doctor_id,t.value.menstrual=e.last_menstrual_time,t.value.check_time=j().format("YYYY-MM-DD"),t.value.status="1",t.value.mother_passport=e.passport},{immediate:!0});const _=m([{title:"孕妈",dataIndex:"mother_id",formType:"select",disabled:!0,dict:{url:"jpro/mother/remote",method:"post",props:{label:"name",value:"id"},translation:!0},commonRules:{required:!0,message:"请选择孕妈"},multiple:!1},{title:"孕妈护照",dataIndex:"mother_passport",formType:"component",component:Y(T)},{title:"月经开始时间",dataIndex:"menstrual",formType:"date",format:"YYYY-MM-DD HH-mm",defaultValue:a.mother.last_menstrual_time,showTime:!0},{title:"医院",dataIndex:"hospital_id",disabled:!0,formType:"select",dict:{url:"jpro/common/hospitals",props:{label:"name",value:"id"},translation:!0},readonly:!0,multiple:!1},{title:"医生",disabled:!0,dataIndex:"doctor_id",formType:"select",dict:{url:"jpro/common/doctors",props:{label:"name",value:"id"},translation:!0},readonly:!0,defaultValue:a.mother.doctor_id,multiple:!1},{title:"检查时间",dataIndex:"check_time",formType:"date",showTime:!1},{title:"状态",dataIndex:"status",formType:"radio",dict:{name:"check_record_status",translation:!0},addDefaultValue:1},{title:"备注",dataIndex:"remark",formType:"input"},{title:"检查详情",dataIndex:"detail",formType:"editor"}]),h=m({showButtons:!1}),v=async()=>{if(await r._rawValue.validateForm())return!1;await k.save(r._rawValue.getFormData()).then(e=>{if(e.success)return a.parentCrudRef.refresh(),d.success(e.message||"操作成功！"),s(),!0;if(e.success===!1&&(typeof e.code>"u"||e.code!==200))return d.clear(),d.error(e.message||"操作失败！"),!1})},x=()=>{l.value=!0},s=()=>{l.value=!1};return f({cancel:s,open:x}),(e,i)=>{const y=n("ma-form"),b=n("a-modal");return C(),M(b,{visible:l.value,"on-before-ok":v,onCancel:s,width:"1000px",fullscreen:u.value},{title:c(()=>[D(" 新增就诊记录 ")]),default:c(()=>[F(y,{modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=w=>t.value=w),columns:_,options:h,ref_key:"crudForm",ref:r},null,8,["modelValue","columns","options"])]),_:1},8,["visible","fullscreen"])}}};export{q as default};
