import{k as a,fy as w,x as j,a0 as T,S as c,r as n,o as V,h as C,w as m,f as F,d as I,M as d}from"./index-DRDJec9Y.js";import{j as g}from"./jproCheckRecord-Dx29QuH6.js";const Y={__name:"addCheckRecord",props:{mother:{type:Object,required:!0},parentCrudRef:{type:Object,required:!0}},setup(p,{expose:f}){const o=p,r=a(),t=a({}),l=a(!1),i=a(!1);w(e=>{i.value=e.isFull}),j(()=>o.mother,e=>{t.value.mother_id=e.id,t.value.hospital_id=e.hospital_id,t.value.doctor_id=e.doctor_id,t.value.check_time=T().format("YYYY-MM-DD")},{immediate:!0});const _=c([{title:"孕妈",dataIndex:"mother_id",formType:"select",disabled:!0,dict:{url:"jpro/mother/remote",method:"post",props:{label:"name",value:"id"},translation:!0},commonRules:{required:!0,message:"请选择孕妈"},multiple:!1},{title:"医院",dataIndex:"hospital_id",disabled:!0,formType:"select",dict:{url:"jpro/common/hospitals",props:{label:"name",value:"id"},translation:!0},readonly:!0,multiple:!1},{title:"医生",disabled:!0,dataIndex:"doctor_id",formType:"select",dict:{url:"jpro/common/doctors",props:{label:"name",value:"id"},translation:!0},readonly:!0,defaultValue:o.mother.doctor_id,multiple:!1},{title:"检查时间",dataIndex:"check_time",formType:"date",showTime:!1},{title:"备注",dataIndex:"remark",formType:"input"},{title:"检查详情",dataIndex:"detail",formType:"editor"}]),h=c({showButtons:!1}),v=async()=>{if(await r._rawValue.validateForm())return!1;await g.save(r._rawValue.getFormData()).then(e=>{if(e.success)return o.parentCrudRef.refresh(),d.success(e.message||"操作成功！"),s(),!0;if(e.success===!1&&(typeof e.code>"u"||e.code!==200))return d.clear(),d.error(e.message||"操作失败！"),!1})},y=()=>{l.value=!0},s=()=>{l.value=!1};return f({cancel:s,open:y}),(e,u)=>{const b=n("ma-form"),x=n("a-modal");return V(),C(x,{visible:l.value,"on-before-ok":v,onCancel:s,width:"1000px",fullscreen:i.value},{title:m(()=>[F(" 新增就诊记录 ")]),default:m(()=>[I(b,{modelValue:t.value,"onUpdate:modelValue":u[0]||(u[0]=k=>t.value=k),columns:_,options:h,ref_key:"crudForm",ref:r},null,8,["modelValue","columns","options"])]),_:1},8,["visible","fullscreen"])}}};export{Y as default};
