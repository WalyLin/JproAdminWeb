import{k as o,fy as w,x as T,a0 as V,S as m,r as n,o as j,h as I,w as c,f as Y,d as C,M as d}from"./index-XTpptOMG.js";import{j as M}from"./jproCheckRecord-CjccqKgL.js";const D={__name:"addCheckRecord",props:{mother:{type:Object,required:!0},parentCrudRef:{type:Object,required:!0}},setup(f,{expose:p}){const a=f,r=o(),t=o({}),l=o(!1),u=o(!1);w(e=>{u.value=e.isFull}),T(()=>a.mother,e=>{t.value.mother_id=e.id,t.value.hospital_id=e.hospital_id,t.value.doctor_id=e.doctor_id,t.value.menstrual=e.last_menstrual_time,t.value.check_time=V().format("YYYY-MM-DD"),t.value.status="1"},{immediate:!0});const _=m([{title:"孕妈",dataIndex:"mother_id",formType:"select",disabled:!0,dict:{url:"jpro/mother/remote",method:"post",props:{label:"name",value:"id"},translation:!0},commonRules:{required:!0,message:"请选择孕妈"},multiple:!1},{title:"医院",dataIndex:"hospital_id",disabled:!0,formType:"select",dict:{url:"jpro/common/hospitals",props:{label:"name",value:"id"},translation:!0},readonly:!0,multiple:!1},{title:"医生",disabled:!0,dataIndex:"doctor_id",formType:"select",dict:{url:"jpro/common/doctors",props:{label:"name",value:"id"},translation:!0},readonly:!0,defaultValue:a.mother.doctor_id,multiple:!1},{title:"月经开始时间",dataIndex:"menstrual",formType:"date",format:"YYYY-MM-DD HH-mm",defaultValue:a.mother.last_menstrual_time,showTime:!0},{title:"检查时间",dataIndex:"check_time",formType:"date",showTime:!1},{title:"状态",dataIndex:"status",formType:"radio",dict:{name:"check_record_status",translation:!0}},{title:"备注",dataIndex:"remark",formType:"input"},{title:"检查详情",dataIndex:"detail",formType:"editor"}]),h=m({showButtons:!1}),v=async()=>{if(await r._rawValue.validateForm())return!1;await M.save(r._rawValue.getFormData()).then(e=>{if(e.success)return a.parentCrudRef.refresh(),d.success(e.message||"操作成功！"),s(),!0;if(e.success===!1&&(typeof e.code>"u"||e.code!==200))return d.clear(),d.error(e.message||"操作失败！"),!1})},y=()=>{l.value=!0},s=()=>{l.value=!1};return p({cancel:s,open:y}),(e,i)=>{const x=n("ma-form"),b=n("a-modal");return j(),I(b,{visible:l.value,"on-before-ok":v,onCancel:s,width:"1000px",fullscreen:u.value},{title:c(()=>[Y(" 新增就诊记录 ")]),default:c(()=>[C(x,{modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=k=>t.value=k),columns:_,options:h,ref_key:"crudForm",ref:r},null,8,["modelValue","columns","options"])]),_:1},8,["visible","fullscreen"])}}};export{D as default};
